<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rizz System Dashboard</title>

<style>
body {
  background:#000;
  color:#fff;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  padding:20px;
}
h1 { font-size:34px; margin-bottom:10px; }

input, button {
  padding:12px;
  border-radius:10px;
  border:none;
  font-size:16px;
  margin-right:6px;
}
button { cursor:pointer; }

.card { margin:20px 0; }

.bar {
  width:100%;
  height:14px;
  background:#333;
  border-radius:10px;
  overflow:hidden;
  margin:6px 0;
}
.fill {
  height:100%;
  background:linear-gradient(90deg,#00ff99,#00cc66);
}

.actions button { margin:4px 4px 0 0; }

.badge {
  padding:4px 10px;
  border-radius:8px;
  font-size:12px;
  margin-left:8px;
}
.focus { background:#00ff99; color:#000; }
.active { background:#444; }

.warning {
  background:#ffb300;
  color:#000;
  padding:12px;
  border-radius:10px;
  margin:15px 0;
  display:none;
}
</style>
</head>

<body>

<h1>ðŸ”¥ Rizz System Dashboard</h1>
<div id="warning" class="warning"></div>

<input id="nameInput" placeholder="Enter name (e.g. Charity)">
<button onclick="addOrUpdate()">Add / Update</button>

<div id="list"></div>

<script>
let data = JSON.parse(localStorage.getItem("rizzData")) || [];
let lastDecay = Number(localStorage.getItem("lastDecay")) || Date.now();

function save() {
  localStorage.setItem("rizzData", JSON.stringify(data));
  localStorage.setItem("lastDecay", lastDecay);
}

function showWarning(msg) {
  warning.innerText = msg;
  warning.style.display = "block";
}
function hideWarning() { warning.style.display = "none"; }

function focusedCount() {
  return data.filter(p => p.state === "FOCUS").length;
}

function removeOldestFocus() {
  const idx = data.findIndex(p => p.state === "FOCUS");
  if (idx !== -1) data[idx].state = "ACTIVE";
}

function addOrUpdate() {
  const name = nameInput.value.trim();
  if (!name) return;

  let p = data.find(x => x.name === name);
  if (!p) {
    data.push({ name, score: 50, state: "ACTIVE" });
  }
  nameInput.value = "";
  autoFocus();
  save();
  render();
}

function adjust(name, val) {
  const p = data.find(x => x.name === name);
  p.score = Math.max(0, Math.min(100, p.score + val));
  autoFocus();
  save();
  render();
}

function setFocus(name) {
  const p = data.find(x => x.name === name);
  if (p.state === "FOCUS") return;

  if (focusedCount() >= 2) {
    removeOldestFocus();
    showWarning("âš ï¸ Focus limit reached â€” oldest focus removed");
  } else hideWarning();

  p.state = "FOCUS";
  save();
  render();
}

function setState(name, state) {
  const p = data.find(x => x.name === name);
  p.state = state;
  hideWarning();
  save();
  render();
}

function del(name) {
  data = data.filter(p => p.name !== name);
  save();
  render();
}

function autoFocus() {
  const candidates = data.filter(p => p.score >= 90 && p.state !== "FOCUS");
  for (let p of candidates) {
    if (focusedCount() < 2) {
      p.state = "FOCUS";
      showWarning(`âš¡ Auto-Focus: ${p.name} reached ${p.score}%`);
    }
  }
}

function decaySystem() {
  const TWO_DAYS = 1000 * 60 * 60 * 24 * 2;
  const now = Date.now();
  const diff = now - lastDecay;

  if (diff >= TWO_DAYS) {
    const cycles = Math.floor(diff / TWO_DAYS);
    data.forEach(p => {
      if (p.state === "ACTIVE") p.score = Math.max(0, p.score - 5 * cycles);
      if (p.state === "PAUSE")  p.score = Math.max(0, p.score - 2 * cycles);
    });
    lastDecay = now;
    save();
  }
}

function render() {
  list.innerHTML = "";
  data.forEach(p => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      <strong>${p.name} â€” ${p.score}%</strong>
      <span class="badge ${p.state === "FOCUS" ? "focus" : "active"}">${p.state}</span>
      <div class="bar"><div class="fill" style="width:${p.score}%"></div></div>
      <div class="actions">
        <button onclick="adjust('${p.name}',-10)">-10</button>
        <button onclick="adjust('${p.name}',10)">+10</button>
        <button onclick="setFocus('${p.name}')">Focus</button>
        <button onclick="setState('${p.name}','PAUSE')">Pause</button>
        <button onclick="setState('${p.name}','ACTIVE')">Active</button>
        <button onclick="del('${p.name}')">Delete</button>
      </div>
    `;
    list.appendChild(div);
  });
}

decaySystem();
render();
</script>

</body>
</html>