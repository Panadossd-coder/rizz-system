<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ðŸ”¥ Rizz System â€” Version 1 (Phase A)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  background:#000;
  color:#fff;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  padding:20px;
}
h1 { font-size:26px; }
input, button {
  padding:12px;
  border-radius:14px;
  border:none;
  font-size:15px;
}
button { background:#eaeaea; }
.card {
  background:#0d0d0d;
  border-radius:18px;
  padding:16px;
  margin-top:18px;
}
.bar {
  height:10px;
  background:#222;
  border-radius:10px;
  overflow:hidden;
  margin:8px 0;
}
.fill {
  height:100%;
  background:linear-gradient(90deg,#00ff99,#00cc88);
}
.focus {
  background:#00ff99;
  color:#000;
  padding:4px 10px;
  border-radius:12px;
  font-size:12px;
}
.thumb {
  width:60px;
  height:60px;
  object-fit:cover;
  border-radius:10px;
  margin-top:10px;
}
.row { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
.small { font-size:13px; opacity:.7; margin-top:6px; }
</style>
</head>

<body>

<h1>ðŸ”¥ Rizz System â€” Version 1<br>(Phase A: Predictions)</h1>

<input id="nameInput" placeholder="Add name (e.g. Charity)">
<button onclick="addPerson()">Add / Update</button>
<button onclick="runDecay()">Run Decay (test)</button>

<div id="list"></div>

<input type="file" id="filePicker" accept="image/*" hidden>

<script>
let data = JSON.parse(localStorage.getItem("rizz_v1")) || [];
let attachTarget = null;

function save() {
  localStorage.setItem("rizz_v1", JSON.stringify(data));
}

function addPerson() {
  const name = nameInput.value.trim();
  if (!name) return;
  let p = data.find(x=>x.name===name);
  if (!p) {
    p = { name, score:0, focus:false, updated:Date.now(), shots:[] };
    data.push(p);
  }
  p.updated = Date.now();
  autoFocus();
  save();
  render();
  nameInput.value="";
}

function autoFocus() {
  const focused = data.filter(p=>p.focus);
  data.forEach(p=>{
    if (p.score >= 90 && !p.focus && focused.length < 2) {
      p.focus = true;
    }
  });
  while (data.filter(p=>p.focus).length > 2) {
    data.filter(p=>p.focus)[0].focus = false;
  }
}

function changeScore(p, d) {
  p.score = Math.max(0, Math.min(100, p.score + d));
  p.updated = Date.now();
  autoFocus();
  save(); render();
}

function toggleFocus(p) {
  if (!p.focus && data.filter(x=>x.focus).length >= 2) {
    data.filter(x=>x.focus)[0].focus = false;
  }
  p.focus = !p.focus;
  save(); render();
}

function runDecay() {
  data.forEach(p=>{
    const days = (Date.now() - p.updated) / (1000*60*60*24);
    if (days >= 2) p.score = Math.max(0, p.score - 10);
  });
  save(); render();
}

function attach(p) {
  attachTarget = p;
  filePicker.click();
}

filePicker.onchange = e => {
  const file = e.target.files[0];
  if (!file || !attachTarget) return;
  const reader = new FileReader();
  reader.onload = () => {
    attachTarget.shots.push(reader.result);
    save(); render();
  };
  reader.readAsDataURL(file);
};

function prediction(p) {
  return Math.round(p.score + (p.focus?30:0));
}

function render() {
  list.innerHTML="";
  data.forEach(p=>{
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=`
      <b>${p.name} â€” ${p.score}%</b>
      ${p.focus?'<span class="focus">FOCUS</span>':""}
      <div class="bar"><div class="fill" style="width:${p.score}%"></div></div>
      <div class="row">
        <button onclick="changeScore(data[${data.indexOf(p)}],-10)">-10</button>
        <button onclick="changeScore(data[${data.indexOf(p)}],10)">+10</button>
        <button onclick="toggleFocus(data[${data.indexOf(p)}])">${p.focus?"Unfocus":"Focus"}</button>
        <button onclick="attach(data[${data.indexOf(p)}])">ðŸ“· Attach</button>
        <button onclick="data.splice(${data.indexOf(p)},1);save();render()">Delete</button>
      </div>
      <div class="small">Prediction: ${prediction(p)} â€” ${prediction(p)>110?"Most Likely":"Developing"}</div>
      ${p.shots.map(s=>`<img class="thumb" src="${s}">`).join("")}
    `;
    list.appendChild(c);
  });
}

render();
</script>

</body>
</html>