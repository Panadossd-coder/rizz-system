<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Rizz System Dashboard</title>

<style>
body {
  background:#000;
  color:#fff;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  padding:20px;
}

h1 { font-size:32px; }

input {
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
  margin-bottom:10px;
}

button {
  padding:12px 16px;
  border-radius:14px;
  border:none;
  margin:6px 6px 6px 0;
  font-weight:600;
}

.primary { background:#e5e5e5; color:#000; }
.warn { background:#fbbf24; color:#000; }
.focus { background:#22c55e; color:#000; }
.gray { background:#333; color:#ccc; }

.bar {
  height:14px;
  border-radius:10px;
  background:#333;
  overflow:hidden;
  margin:6px 0 10px;
}

.fill {
  height:100%;
  background:linear-gradient(90deg,#22c55e,#00ff99);
}

.card { margin-bottom:30px; }

.badge {
  display:inline-block;
  padding:6px 12px;
  border-radius:12px;
  font-size:13px;
  margin-left:10px;
}

.notice {
  background:#fbbf24;
  color:#000;
  padding:14px;
  border-radius:14px;
  margin-bottom:15px;
}
</style>
</head>

<body>

<h1>ðŸ”¥ Rizz System Dashboard</h1>

<div id="notice"></div>

<input id="nameInput" placeholder="Enter name (e.g. Charity)" />

<button class="primary" onclick="addPerson()">Add / Update</button>
<button class="primary" onclick="clearAll()">Clear All</button>
<button class="primary" onclick="runDecay(true)">Run Decay (test)</button>

<div id="list"></div>

<script>
const FOCUS_LIMIT = 2;
const DECAY_DAYS = 2;
const DECAY_AMOUNT = 10;

let people = JSON.parse(localStorage.getItem("rizzData")) || {};
let lastDecay = Number(localStorage.getItem("lastDecay")) || Date.now();

function save() {
  localStorage.setItem("rizzData", JSON.stringify(people));
  localStorage.setItem("lastDecay", lastDecay);
}

function addPerson() {
  const name = nameInput.value.trim();
  if (!name) return show("Please enter a name");
  if (!people[name]) {
    people[name] = { score:0, focus:false, focusTime:0, status:"ACTIVE" };
    show("Added " + name);
  }
  nameInput.value="";
  save();
  render();
}

function changeScore(name, delta) {
  people[name].score = Math.max(0, Math.min(100, people[name].score + delta));
  autoFocusCheck(name);
  save();
  render();
}

function toggleFocus(name) {
  people[name].focus = true;
  people[name].focusTime = Date.now();
  enforceFocusLimit();
  save();
  render();
}

function enforceFocusLimit() {
  const focused = Object.entries(people)
    .filter(([_,p]) => p.focus)
    .sort((a,b)=>a[1].focusTime - b[1].focusTime);

  while (focused.length > FOCUS_LIMIT) {
    const [oldest] = focused.shift();
    people[oldest].focus = false;
    show("Focus limit reached â€” oldest focus removed");
  }
}

function autoFocusCheck(name) {
  if (people[name].score >= 90 && !people[name].focus) {
    toggleFocus(name);
    show("Auto-Focus: reached 90%");
  }
}

function runDecay(force=false) {
  const now = Date.now();
  if (!force && now - lastDecay < DECAY_DAYS*86400000) return;
  Object.values(people).forEach(p=>{
    if (!p.focus && p.score>0) {
      p.score = Math.max(0, p.score - DECAY_AMOUNT);
    }
  });
  lastDecay = now;
  save();
  render();
}

function clearAll() {
  if (!confirm("Clear everything?")) return;
  people = {};
  save();
  render();
}

function removePerson(name) {
  delete people[name];
  save();
  render();
}

function show(msg) {
  notice.innerHTML = `<div class="notice">${msg}</div>`;
  setTimeout(()=>notice.innerHTML="",3000);
}

function render() {
  enforceFocusLimit();
  list.innerHTML = "";
  Object.entries(people).forEach(([name,p])=>{
    list.innerHTML += `
    <div class="card">
      <strong>${name} â€” ${p.score}%</strong>
      <span class="badge ${p.focus?'focus':'gray'}">${p.focus?'FOCUS':p.status}</span>
      <div class="bar"><div class="fill" style="width:${p.score}%"></div></div>
      <button onclick="changeScore('${name}',-10)">-10</button>
      <button onclick="changeScore('${name}',10)">+10</button>
      <button onclick="toggleFocus('${name}')">Focus</button>
      <button onclick="people['${name}'].focus=false;save();render()">Pause</button>
      <button onclick="removePerson('${name}')">Delete</button>
    </div>`;
  });
}

runDecay();
render();
</script>

<p style="color:#777;font-size:13px">
Tip: +10/-10 clamps 0â€“100. Focus limit = 2. Decay every 2 days.
</p>

</body>
</html>
