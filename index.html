<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ðŸ”¥ Rizz System â€” Version 1 (Phase A)</title>

<style>
body {
  background:#000;
  color:#fff;
  font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto;
  margin:0;
  padding:20px;
}
h1 { font-size:28px; margin-bottom:15px; }
input,button {
  border:none;
  border-radius:14px;
  padding:14px;
  font-size:15px;
}
input { width:100%; margin-bottom:10px; }
button {
  background:#e6e6e6;
  margin:5px 4px;
}
.primary { background:#dbeafe; }
.danger { background:#ff7b7b; }
.focus { background:#22c55e; color:#000; font-weight:600; }
.card {
  background:#111;
  border-radius:18px;
  padding:15px;
  margin-top:15px;
}
.bar {
  height:12px;
  background:#222;
  border-radius:10px;
  overflow:hidden;
}
.fill {
  height:100%;
  background:linear-gradient(90deg,#00ffa3,#00c6ff);
}
.badge {
  padding:6px 12px;
  border-radius:12px;
  font-size:13px;
}
.gray { background:#333; }
.green { background:#22c55e; color:#000; }
.thumb {
  width:70px;
  border-radius:8px;
  margin-top:8px;
}
small { color:#aaa; }
</style>
</head>

<body>

<h1>ðŸ”¥ Rizz System â€” Version 1 (Phase A)</h1>

<input id="nameInput" placeholder="Add name (e.g. Charity)" />
<button class="primary" onclick="addPerson()">Add / Update</button>
<button onclick="runDecay()">Run Decay (test)</button>

<div id="list"></div>

<small>
+10 / -10 clamps to 0â€“100.  
Auto-focus at â‰¥90%.  
Focus limit = 2.  
Decay âˆ’10 every 2 days.  
Saved locally.
</small>

<script>
let data = JSON.parse(localStorage.getItem("rizz_v1")) || {};

function save() {
  localStorage.setItem("rizz_v1", JSON.stringify(data));
}

function addPerson() {
  const name = nameInput.value.trim();
  if (!name) return;
  if (!data[name]) {
    data[name] = {
      score: 0,
      focus: false,
      paused: false,
      updated: Date.now(),
      shots: []
    };
  }
  save();
  render();
  nameInput.value="";
}

function setScore(name, delta) {
  const p = data[name];
  if (p.paused) return;
  p.score = Math.max(0, Math.min(100, p.score + delta));
  p.updated = Date.now();
  autoFocus();
  save();
  render();
}

function autoFocus() {
  const focused = Object.values(data).filter(p=>p.focus).length;
  Object.entries(data).forEach(([name,p])=>{
    if (p.score >= 90 && !p.focus && focused < 2) {
      p.focus = true;
    }
  });
}

function toggleFocus(name) {
  const focused = Object.values(data).filter(p=>p.focus).length;
  if (!data[name].focus && focused >= 2) return;
  data[name].focus = !data[name].focus;
  save();
  render();
}

function togglePause(name) {
  data[name].paused = !data[name].paused;
  save();
  render();
}

function del(name) {
  delete data[name];
  save();
  render();
}

function runDecay() {
  const now = Date.now();
  Object.values(data).forEach(p=>{
    const days = (now - p.updated) / (1000*60*60*24);
    if (days >= 2 && !p.paused) {
      p.score = Math.max(0, p.score - 10);
      p.updated = now;
      if (p.score < 90) p.focus = false;
    }
  });
  save();
  render();
}

function attach(name, file) {
  const reader = new FileReader();
  reader.onload = e => {
    data[name].shots.push(e.target.result);
    save();
    render();
  };
  reader.readAsDataURL(file);
}

function prediction(score) {
  if (score >= 90) return "Most Likely";
  if (score >= 70) return "Possible";
  return "Unlikely";
}

function render() {
  list.innerHTML="";
  Object.entries(data).forEach(([name,p])=>{
    const card = document.createElement("div");
    card.className="card";

    card.innerHTML = `
      <b>${name} â€” ${p.score}%</b>
      <span class="badge ${p.focus?"green":"gray"}">
        ${p.focus?"FOCUS":p.paused?"PAUSED":"ACTIVE"}
      </span>

      <div class="bar"><div class="fill" style="width:${p.score}%"></div></div>

      <div>
        <button onclick="setScore('${name}',-10)">-10</button>
        <button onclick="setScore('${name}',10)">+10</button>
        <button onclick="toggleFocus('${name}')">${p.focus?"Unfocus":"Focus"}</button>
        <button onclick="togglePause('${name}')">${p.paused?"Active":"Pause"}</button>
        <button class="danger" onclick="del('${name}')">Delete</button>
        <label>
          <button>ðŸ“· Attach</button>
          <input type="file" hidden accept="image/*"
            onchange="attach('${name}',this.files[0])">
        </label>
      </div>

      <small>Prediction: ${prediction(p.score)}</small>
    `;

    p.shots.forEach(s=>{
      const img = document.createElement("img");
      img.src = s;
      img.className="thumb";
      card.appendChild(img);
    });

    list.appendChild(card);
  });
}

render();
</script>

</body>
</html>